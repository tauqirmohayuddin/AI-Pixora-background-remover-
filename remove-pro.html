async function callRemoveBg(dataUrl) {
  try {
    const res = await fetch('/.netlify/functions/remove-bg', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ imageBase64: dataUrl })
    });
    if (!res.ok) {
      const txt = await res.text();
      throw new Error('Function returned: ' + res.status + ' ' + txt);
    }
    const base64 = await res.text(); // netlify returns body base64 string
    // If Netlify sets isBase64Encoded: true and returns body (text) â€” this works.
    // Convert to blob and show or download:
    const b64 = base64; // it is already base64 string
    const bin = atob(b64);
    const len = bin.length;
    const arr = new Uint8Array(len);
    for (let i = 0; i < len; i++) arr[i] = bin.charCodeAt(i);
    const blob = new Blob([arr], { type: 'image/png' });
    const url = URL.createObjectURL(blob);
    // show in image element, or create a download link:
    document.getElementById('resultImg').src = url;
  } catch (err) {
    console.error(err);
    alert('Remove failed: ' + err.message);
  }
}
